<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Aula 3: O Primeiro Relacionamento e Medidas DAX</title>
  <link rel="stylesheet" href="styles2.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
</head>

<body>
  <!-- Bot√£o FIXO de altern√¢ncia de tema (clique para alterar) -->
  <button id="theme-toggle" class="theme-toggle-btn" aria-label="Alternar tema">
    <i class="fas fa-sun"></i>
  </button>

  <div class="overlay" id="overlay"></div>

  <button class="hamburger-menu" id="hamburger-menu">
    <i class="fas fa-bars"></i>
  </button>

  <div class="sidebar" id="sidebar">
    <button class="sidebar-toggle-btn" id="sidebar-toggle-btn">
      <i class="fas fa-chevron-left"></i>
    </button>

    <h2><span class="sidebar-title-text">Power BI </span>üìä</h2>

    <a href="index.html"><i class="fas fa-home"></i> <span>In√≠cio Power BI</span></a>
    <a href="Introducao_BI_e_Power_BI.html"><i class="fas fa-rocket"></i> <span>Aula 1: Intro BI</span></a>
    <a href="Aula_02_Modelagem.html"><i class="fas fa-project-diagram"></i> <span>Aula 2: Modelagem</span></a>
    <a href="Aula_03_Criacao_Relacionamento.html" class="active"><i class="fas fa-sitemap"></i> <span>Aula 3: Relacionamentos</span></a>
  </div>

  <main class="content" id="content">
    <header>
      <h1>Aula 3: Construindo o Modelo - O Primeiro Relacionamento e Medidas DAX</h1>
      <p>Nesta aula, finalizamos o tratamento de erros e importamos a Tabela Fato. Voc√™ aprender√° a criar relacionamentos e far√° seus primeiros c√°lculos de alta performance com a linguagem DAX.</p>
    </header>

    <section class="main-section">

      <blockquote class="thought-of-the-day">
        <p>"Carregando cita√ß√£o..."</p>
        <cite>‚Äî</cite>
      </blockquote>
      
      <section class="sub-section" style="border-left-color: var(--cor-borda-vermelho);">
        <h2>1Ô∏è‚É£ Revis√£o: √öltimo Caso de Erro de Conex√£o <i class="fas fa-bug"></i></h2>
        <p>Na aula passada, aprendemos a corrigir erros de renomea√ß√£o de abas e colunas. Agora, vamos tratar o erro mais comum: a **mudan√ßa de local** do seu arquivo Excel ou CSV.</p>
        
        <div class="card">
            <h4>O Problema: Arquivo N√£o Encontrado (Realoca√ß√£o ou Exclus√£o)</h4>
            <p>Se a fonte de dados for movida ou exclu√≠da, o Power BI continuar√° funcionando no modo de Relat√≥rio (devido ao **cache interno**), mas falhar√° ao tentar atualizar.</p>
            <p>O problema s√≥ aparece quando voc√™ tenta atualizar, vendo o erro expl√≠cito informando que o arquivo n√£o foi encontrado no caminho original.</p>
            <img src="img/Arquivo N√£o Encontrado.png" alt="Mensagem de erro de conex√£o no Power BI Desktop, indicando que a fonte de dados n√£o foi encontrada no caminho especificado." class="screenshot">
        </div>

        <div class="card">
            <h4>Solu√ß√£o 1: A Op√ß√£o Visual (Engrenagem da Fonte)</h4>
            <p>A corre√ß√£o mais direta para a realoca√ß√£o √© feita clicando na engrenagem da etapa **"Fonte"** no painel **Etapas Aplicadas** dentro do Power Query.</p>
            <ol>
                <li>No Power Query, a tabela com erro mostrar√° uma **barra listrada de vermelho** sob o cabe√ßalho das colunas. Esta barra **acusa que h√° algo de errado** com a fonte.</li>
                <li>No painel **Etapas Aplicadas**, clique duas vezes na engrenagem (Configura√ß√µes) da etapa **"Fonte"**.
                <li>O Power BI abrir√° o modal (janela de navega√ß√£o de arquivos), permitindo que voc√™ selecione o arquivo em sua **nova localiza√ß√£o**.</li>
            </ol>
            <img src="img/Barra listrada de vermelho cabe√ßalho.png" alt="Barra listrada de vermelho no Power Query sob o cabe√ßalho das colunas, indicando um erro de fonte de dados antes de atualizar." class="screenshot">
            <img src="img/Altera√ß√£o do caminho da pasta.png" alt="Modal de busca de arquivos que aparece ao clicar duas vezes na engrenagem da etapa 'Fonte'." class="screenshot">
        </div>

        <div class="card">
            <h4>Solu√ß√£o 2: Gerenciamento Centralizado (**Configura√ß√µes da Fonte de Dados**)</h4>
            <p>Este √© o local central para resolver problemas de caminho de arquivo para **todas** as tabelas de uma s√≥ vez, especialmente √∫til se v√°rios arquivos foram movidos ou renomeados.</p>
            <p>Acesse esta op√ß√£o na Guia **P√°gina Inicial** (no modo de Relat√≥rio), clicando na seta ao lado de **"Transformar Dados"** e escolhendo **"Configura√ß√µes da Fonte de Dados"**.</p>
            <img src="img/Pagina inicial - Transformar dados - Configura√ß√µes da fonte de dados.png" alt="Guia P√°gina Inicial com o menu Transformar Dados expandido e a op√ß√£o 'Configura√ß√µes da Fonte de Dados' destacada." class="screenshot">
        </div>
      </section>

      <section class="sub-section">
        <h2>2Ô∏è‚É£ Importando e Tratando a Tabela Dimens√£o: `dLojas` <i class="fas fa-store"></i></h2>
        <p>Vamos finalizar o tratamento da tabela de lojas e corrigir o erro de tipo de dado que simulamos na √∫ltima aula.</p>

        <div class="card">
            <h4>Revis√£o: Dimens√£o vs. Fato</h4>
            <p>A tabela **`dLojas`** √© uma **Dimens√£o** porque ela *descreve* o local e o gerente, que s√£o atributos usados para segmentar as vendas. Tabela **Fato** cont√©m **medi√ß√µes**.</p>
        </div>

        <div class="card">
  <h4>Simula√ß√£o e Corre√ß√£o do Erro de Tipo Misto (<code>dLojas</code>)</h4>
  <p>No arquivo Excel (<code>Cadastro Lojas.xlsx</code>), adicione a linha de dados abaixo. O campo <strong>Documento do Gerente</strong> deve ser digitado com a letra <strong>'A'</strong> para causar o erro de convers√£o de tipo (N√∫mero para Misto).</p>

  <pre><code>| ID Loja | Nome da Loja        | Quantidade Colaboradores | Tipo   | ID Localidade | Gerente Loja     | Documento do Gerente |
|---------|---------------------|------------------------|--------|---------------|------------------|----------------------|
| 311     | Loja Lyon - Fran√ßa  | 30                     | Fisica | 4             | Rivail, Hyppolyte| 123456A              |</code></pre>

  <p>Ap√≥s adicionar e salvar a linha no Excel, clique em <strong>Atualizar</strong> no Power BI. O erro ocorrer√°, e a solu√ß√£o √© mudar o tipo da coluna <strong>"Documento do Gerente"</strong> para <strong>Texto</strong>.</p>
  <p>Ap√≥s a corre√ß√£o, use a consulta tempor√°ria <strong>"Erros em..."</strong> para deletar a linha com erro ou exclua a consulta tempor√°ria de erros (<code>Erros em...</code>) por completo.</p>
</div>


        <div class="card">
            <h4>Manipula√ß√£o 1: Removendo o Prefixo "Loja"</h4>
            <p>Vamos limpar a coluna **"Nome da Loja"** (`Loja [Nome]`). Selecione a coluna e, na guia **Transformar**, use **Extrair** > **Texto ap√≥s o Delimitador**. Defina o delimitador como um **espa√ßo** (` `) e escolha o **Delimitador mais √† esquerda** para remover o prefixo "Loja".</p>
        </div>

        <div class="card">
            <h4>Manipula√ß√£o 2: Extra√ß√£o Otimizada do Gerente (Coluna de Exemplos)</h4>
            <p>Usaremos a **Coluna de Exemplos** para extrair e formatar o nome do gerente (Ex: de "Silva, Jo√£o" para "Jo√£o Silva").</p>
            <ol>
                <li>V√° para a guia **Adicionar Coluna** e clique em **Coluna de Exemplos** > **De Sele√ß√£o**.</li>
                <li>Preencha a nova coluna com o nome formatado (Ex: "Jo√£o Silva"). O Power Query identificar√° o padr√£o (invers√£o e mesclagem) e preencher√° o restante automaticamente.</li>
            </ol>
        </div>

        <div class="card">
            <h4>Truque: Reordenando Colunas no Power BI (Desabilitar Carga)</h4>
            <p>Para for√ßar a ordem desejada das colunas no Power BI (j√° que arrastar no Power Query nem sempre funciona), use o truque de **Habilitar/Desabilitar Carga** na consulta (`dLojas`).</p>
            <img src="img/Habilitar Carga - movendo coluna.png" alt="Menu de contexto da consulta no Power Query com a op√ß√£o Habilitar Carga marcada, indicando que ela deve ser desmarcada e marcada novamente para for√ßar a reordena√ß√£o." class="screenshot">
        </div>
        <p>Clique em **"Fechar e Aplicar"** para salvar as corre√ß√µes e o truque de reordena√ß√£o.</p>
      </section>

      <section class="sub-section">
        <h2>3Ô∏è‚É£ Manipula√ß√£o Avan√ßada de Texto: Limpando `dLojas` <i class="fas fa-magic"></i></h2>
        <p>Vamos melhorar a apar√™ncia da coluna "Nome da Loja" e extrair o nome e sobrenome do gerente, explorando as op√ß√µes de **Extra√ß√£o de Texto**.</p>
        
        <div class="card">
            <h4>Extrair Texto: Entendendo as Op√ß√µes</h4>
            <p>A fun√ß√£o **Extrair** (na guia **Transformar** ou **Adicionar Coluna**) √© vital para manipular strings. Veja as principais op√ß√µes:</p>
            <img src="img/Extrair texto.png" alt="Menu Extrair na guia Transformar do Power Query, mostrando as op√ß√µes de manipula√ß√£o de texto." class="screenshot">
            <ul>
                <li>**Comprimento:** Pega um n√∫mero exato de caracteres (Ex: os 5 primeiros caracteres de um c√≥digo).</li>
                <li>**Intervalo:** Pega um trecho de texto come√ßando em uma posi√ß√£o e terminando em outra (Ex: do 6¬∫ ao 10¬∫ caractere).</li>
                <li>**Texto Antes/Depois/Entre Delimitadores:** √â a op√ß√£o mais flex√≠vel, permitindo usar caracteres como delimitadores de corte.
                </li>
            </ul>
        </div>
        
        <div class="card">
            <h4>Passo A: Removendo o Prefixo "Loja"</h4>
            <p>A coluna **"Nome da Loja"** sempre come√ßa com "Loja ". Para remover esse prefixo, use a op√ß√£o que melhor se adapta a um padr√£o no in√≠cio do texto:</p>
            <ol>
                <li>Selecione a coluna **"Nome da Loja"**.</li>
                <li>V√° para a guia **Transformar** e selecione **Extrair** > **Texto ap√≥s o Delimitador**.</li>
                <li>Defina o delimitador como **` `** (espa√ßo) e escolha **O Delimitador mais √† esquerda** (ou use a op√ß√£o **Pular Caracteres** e defina 5).</li>
            </ol>
            <p>Usar o delimitador ` ` (espa√ßo) √© o ideal, pois √© menos propenso a erros do que contar caracteres fixos e garante que o Power Query remova o prefixo mais o espa√ßo seguinte.</p>
        </div>

        <div class="card">
            <h4>Passo B: Extra√ß√£o e Otimiza√ß√£o do Gerente</h4>
            <p>A coluna **"Gerente"** est√° no formato "Sobrenome, Nome" (Ex: "Kardec, Allan").</p>
            <ol>
                <li>**Extra√ß√£o Manual (Exemplo Moroso, mas Did√°tico):**
                    <ul>
                        <li>Para o **Nome**, use **Texto ap√≥s o Delimitador** com o delimitador **`, `** (v√≠rgula e espa√ßo).</li>
                        <li>Para o **Sobrenome**, use **Texto antes do Delimitador** com o delimitador **`, `** (v√≠rgula e espa√ßo).</li>
                        <li>Por fim, use **Mesclar Colunas** para juntar "Nome" e "Sobrenome" na ordem correta (Ex: "Allan Kardec").</li>
                    </ul>
                </li>
                <li>**Extra√ß√£o Otimizada (Coluna de Exemplos):**
                    <p>Use a intelig√™ncia artificial do Power Query para fazer todas as etapas acima em uma s√≥ tacada.</p>
                    <ul>
                        <li>V√° para a guia **Adicionar Coluna** e clique em **Coluna de Exemplos**.</li>
                        <li>Preencha a nova coluna com o resultado formatado (Ex: "Allan Kardec"). O Power Query identificar√° o padr√£o de invers√£o e mesclagem automaticamente.</li>
                    </ul>
                    <img src="img/Adicionar coluna de exemplos.png" alt="Preenchendo a coluna de exemplos para que o Power Query identifique o padr√£o de invers√£o e mesclagem de Nome e Sobrenome." class="screenshot">
                </li>
            </ol>
        </div>
      </section>

      <section class="sub-section">
        <h2>4Ô∏è‚É£ Mesclando Tabelas Dimens√£o: Enriquecendo `dLojas` <i class="fas fa-layer-group"></i></h2>
        <p>A tabela `dLojas` tem o `ID Localidade`, mas precisamos dos campos de **Pa√≠s** e **Continente** para an√°lises geogr√°ficas. Eles est√£o na planilha `Cadastro Localidades`.</p>
        
        <div class="card">
            <h4>Passo 1: Importar a Tabela de Localidades</h4>
            <p>Importe a planilha **"Cadastro Localidades.xlsx"** e clique em **"Transformar Dados"**.</p>
            <p><a href="./documentos/Cadastro Localidades.xlsx" download><i class="fas fa-file-excel"></i> Baixar Arquivo "Cadastro Localidades.xlsx"</a></p>
            <p>Renomeie a consulta para **"dLocalidades"** (Tabela Dimens√£o). Fa√ßa a limpeza de rotina. **N√£o clique em "Fechar e Aplicar"**.</p>
        </div>

        <div class="card">
            <h4>Conceito: Mesclar Consultas (JOIN)</h4>
            <p>Mesclar Consultas (Merge Queries) √© o processo no Power Query de **combinar dados de duas tabelas** com base em uma coluna de correspond√™ncia (ID). Este processo √© similar a um **JOIN** em SQL.</p>
            <ul>
                <li>**Mesclar Consultas:** Adiciona as colunas da segunda tabela √† **consulta atualmente selecionada**, expandindo-a.</li>
                <li>**Mesclar Consultas como Nova:** Cria uma **terceira consulta** (tabela) com o resultado da mesclagem, deixando as duas originais intactas.</li>
            </ul>
            <p>Neste caso, queremos **Mesclar Consultas** para enriquecer a `dLojas`.</p>
        </div>

        <div class="card">
            <h4>Passo 2: Realizando a Mesclagem</h4>
            <p>Selecione a tabela **"dLojas"**.</p>
            <ol>
                <li>Na guia **P√°gina Inicial**, no grupo **Combinar**, clique em **Mesclar Consultas** (na setinha, escolha a primeira op√ß√£o).
                    <img src="img/Mesclar Consultas.png" alt="Op√ß√£o Mesclar Consultas no menu Combinar na guia P√°gina Inicial do Power Query." class="screenshot">
                </li>
                <li>Na janela Mesclar:
                    <ul>
                        <li>**Tabela superior (Base):** `dLojas`</li>
                        <li>**Colunas de liga√ß√£o:** Selecione a coluna **"ID Localidade"** em `dLojas`.</li>
                        <li>**Tabela inferior (Adicional):** Selecione `dLocalidades`.</li>
                        <li>**Colunas de liga√ß√£o:** Selecione a coluna **"ID Localidade"** em `dLocalidades`.</li>
                    </ul>
                </li>
            </ol>
            <blockquote class="note">
                <i class="fas fa-star"></i> **Chave de Liga√ß√£o:** As colunas de liga√ß√£o (ID Localidade) n√£o precisam ter o mesmo nome, mas o **conte√∫do** (os IDs) deve ser o mesmo para que a correspond√™ncia funcione.
            </blockquote>
        </div>

        <div class="card">
            <h4>Passo 3: Expandindo as Novas Colunas</h4>
            <p>Ap√≥s o OK na mesclagem, uma nova coluna chamada `dLocalidades` aparecer√°, preenchida com o valor **"Table"**.</p>
            <p>Clique no bot√£o de **Expandir** (setas opostas) no canto superior direito do novo cabe√ßalho da coluna.</p>
            <img src="img/Mesclar Colunas - selecionar colunas - table.png" alt="Janela de Expans√£o de Colunas ap√≥s a mesclagem, mostrando a lista de colunas da tabela 'dLocalidades'." class="screenshot">
            <ol>
                <li>**Selecione as Colunas:** Desmarque a op√ß√£o **"Selecionar Todas as Colunas"** e marque apenas **"Pa√≠s"** e **"Continente"**.</li>
                <li>**Prefixo:** √â uma boa pr√°tica desmarcar a op√ß√£o **"Usar o nome da coluna original como prefixo"**, pois n√£o precisamos de um nome redundante como `dLocalidades.Pa√≠s`.</li>
                <li>Clique em OK.</li>
            </ol>
            <p>Pronto! A tabela `dLojas` agora possui as informa√ß√µes de Pa√≠s e Continente, e a `dLocalidades` pode ser desabilitada do carregamento no modelo (bot√£o direito > desmarque Habilitar Carga).</p>
        </div>
      </section>
      
      <section class="sub-section">
        <h2>5Ô∏è‚É£ Modelagem de Dados: Criando os Relacionamentos <i class="fas fa-link"></i></h2>
        <p>Finalmente, vamos conectar as "ilhas" (Dimens√µes) √† Tabela Fato (o centro da estrela) para que todos os dados possam interagir.</p>

        <div class="card">
            <h4>Navegando at√© a Guia Modelo</h4>
            <p>No Power BI Desktop, clique na **Guia Modelo** (o √≠cone com tr√™s caixas e linhas de liga√ß√£o, no menu vertical √† esquerda).</p>
            <p>Voc√™ ver√° as quatro tabelas que importamos e limpamos: `dClientes`, `dProdutos`, `dLojas` e `fVendas`.</p>
        </div>

        <div class="card">
            <h4>Criando Relacionamentos Manuais (Drag-and-Drop)</h4>
            <p>Para construir a Modelagem de Dados (Esquema Estrela), arraste a chave prim√°ria da Tabela Dimens√£o para a chave estrangeira correspondente na Tabela Fato:</p>
            <ol>
                <li>Ligue `dClientes` (**ID Cliente**) √† `fVendas` (**ID Cliente**).</li>
                <li>Ligue `dProdutos` (**SKU Produto**) √† `fVendas` (**SKU Produto**).</li>
                <li>Ligue `dLojas` (**ID Loja**) √† `fVendas` (**ID Loja**).</li>
            </ol>
            <blockquote class="note">
                <i class="fas fa-star"></i> **Tipos de Rela√ß√£o:** O Power BI define-as como **Um para Muitos (1:*)**.
            </blockquote>
        </div>
      </section>

      <section class="sub-section">
        <h2>6Ô∏è‚É£ Introdu√ß√£o ao DAX: Criando o Primeiro KPI <i class="fas fa-superscript"></i></h2>
        <p>Com os dados conectados, podemos finalmente criar nossas m√©tricas de neg√≥cios (KPIs) usando DAX (Data Analysis Expressions).</p>

        <div class="card">
            <h4>Criando a Primeira Medida: Faturamento Total</h4>
            <p>Para calcular o faturamento total, precisamos multiplicar o **Valor Unit√°rio** pela **Quantidade** em cada linha da tabela `fVendas` e, em seguida, somar o resultado.</p>
            <ol>
                <li>Na Guia **Relat√≥rio** ou **Dados**, clique na tabela `fVendas`.</li>
                <li>Na guia **P√°gina Inicial** (ou Modelagem), clique em **Nova Medida**.</li>
                <li>Insira a seguinte f√≥rmula DAX:</li>
            </ol>
            <pre><code>Faturamento Total = SUMX( fVendas, fVendas[Valor Unit√°rio] * fVendas[Quantidade] )</code></pre>
            <blockquote class="note">
                <i class="fas fa-lightbulb"></i> **Fun√ß√£o SUMX:** O `SUMX` √© um iterador. Ele passa por **cada linha** da tabela (`fVendas`), multiplica os dois campos (`Valor Unit√°rio` * `Quantidade`), e s√≥ ent√£o **soma** o resultado final de todas as linhas.
            </blockquote>
        </div>
      </section>

      <section class="main-section" style="padding-top: 0; margin-top: -20px;">
        <section class="sub-section" style="border-left-color: var(--cor-borda-amarelo-pbi);">
            <h2>üèÜ Conclus√£o da Aula 3</h2>
            <p>Parab√©ns! Voc√™ dominou o tratamento de dados (ETL), a corre√ß√£o dos erros mais cr√≠ticos, e agora tem as Tabelas Dimens√£o prontas e conectadas.</p>
            <p style="font-weight: bold; font-size: 1.1em;">Na pr√≥xima aula, vamos:</p>
            <ul>
                <li>Importar e tratar as demais Tabelas Fato (`fDevolu√ß√µes`).</li>
                <li>Aprofundar em DAX, aprendendo a usar a fun√ß√£o **CALCULATE** para criar Medidas Inteligentes.</li>
                <li>Criar o primeiro **Dashboard Simples** para visualizar nossos KPIs.</li>
            </ul>
        </section>
      </section>

    </section>

  </main>

  <a href="#" id="back-to-top" class="back-to-top" title="Voltar ao topo">
    <i class="fas fa-chevron-up"></i>
  </a>

  <script src="js/quotes.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {

      // --- C√ìDIGO DA CITA√á√ÉO RAND√îMICA ---
      const quoteElement = document.querySelector('.thought-of-the-day p');
      const authorElement = document.querySelector('.thought-of-the-day cite');

      if (quoteElement && authorElement && typeof quotes !== 'undefined' && quotes.length > 0) {
        const randomIndex = Math.floor(Math.random() * quotes.length);
        const randomQuote = quotes[randomIndex];

        quoteElement.textContent = `"${randomQuote.quote}"`;
        authorElement.textContent = `‚Äî ${randomQuote.author}`;
      } else if (quoteElement) {
         quoteElement.textContent = "Bem-vindo √† sua jornada de dados.";
         authorElement.textContent = "";
      }
      
      // --- C√ìDIGO DO MENU HAMB√öRGUER (Mobile) ---
      const sidebar = document.getElementById('sidebar');
      const content = document.getElementById('content');
      const hamburgerMenu = document.getElementById('hamburger-menu');
      const overlay = document.getElementById('overlay');
      const sidebarLinks = sidebar.querySelectorAll('a');

      function toggleSidebarMobile() {
        sidebar.classList.toggle('active');
        content.classList.toggle('sidebar-active');
        overlay.classList.toggle('active');
      }

      hamburgerMenu.addEventListener('click', toggleSidebarMobile);
      overlay.addEventListener('click', toggleSidebarMobile);

      // --- L√ìGICA DE CLIQUE NOS LINKS ---
      sidebarLinks.forEach(link => {
        link.addEventListener('click', function(event) {

          if (link.classList.contains('active')) {
            event.preventDefault();

            if (sidebar.classList.contains('active')) {
              toggleSidebarMobile();
            }
            return;
          }

          if (sidebar.classList.contains('active')) {
            toggleSidebarMobile();
          }
        });
      });

      // --- C√ìDIGO DO TOGGLE DO SIDEBAR (DESKTOP) ---
      const desktopToggleBtn = document.getElementById('sidebar-toggle-btn');
      if (desktopToggleBtn) {
        desktopToggleBtn.addEventListener('click', () => {
          if (window.innerWidth > 768) {
            sidebar.classList.toggle('sidebar-mini');
            content.classList.toggle('sidebar-mini');
          }
        });
      }

      // --- C√ìDIGO DO BOT√ÉO "VOLTAR AO TOPO" ---
      const backToTopButton = document.getElementById('back-to-top');
      window.addEventListener('scroll', () => {
        if (window.scrollY > 300) {
          backToTopButton.classList.add('show');
        } else {
          backToTopButton.classList.remove('show');
        }
      });

      // --- C√ìDIGO DO BOT√ÉO "MOSTRAR RESPOSTA" ---
      const toggleBtn = document.querySelector('.toggle-answer-btn');
      const answerDiv = document.querySelector('.answer');
      if (toggleBtn && answerDiv) {
        toggleBtn.addEventListener('click', () => {
          const isVisible = answerDiv.style.display === 'block';
          if (isVisible) {
            answerDiv.style.display = 'none';
            toggleBtn.innerHTML = '<i class="fas fa-eye"></i> Mostrar Gabarito';
          } else {
            answerDiv.style.display = 'block';
            toggleBtn.innerHTML = '<i class="fas fa-eye-slash"></i> Esconder Gabarito';
          }
        });
      }

      // --- TOGGLE DE TEMA (dark-mode padr√£o) ---
      const themeToggleBtn = document.getElementById('theme-toggle');
      const body = document.body;
      const themeIcon = themeToggleBtn.querySelector('i');

      // Fun√ß√£o para aplicar tema
      function applyTheme(theme) {
        if (theme === 'light') {
          body.classList.add('light-mode');
          body.classList.remove('dark-mode');
          themeIcon.classList.remove('fa-sun');
          themeIcon.classList.add('fa-moon');
        } else {
          body.classList.add('dark-mode');
          body.classList.remove('light-mode');
          themeIcon.classList.remove('fa-moon');
          themeIcon.classList.add('fa-sun');
        }
      }

      // Inicializa√ß√£o: usa o que estiver no localStorage ou padr√£o 'dark'
      const savedTheme = localStorage.getItem('site-theme');
      applyTheme(savedTheme ? savedTheme : 'dark');

      // Clique no bot√£o alterna e salva prefer√™ncia
      themeToggleBtn.addEventListener('click', () => {
        const isCurrentlyDark = body.classList.contains('dark-mode');
        const newTheme = isCurrentlyDark ? 'light' : 'dark';
        applyTheme(newTheme);
        localStorage.setItem('site-theme', newTheme);
      });

    });
  </script>
</body>

</html>
