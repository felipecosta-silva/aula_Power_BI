<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Aula 4: Importando a Base de Vendas 2020</title>

  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
</head>

<body>
  <div class="overlay" id="overlay"></div>

  <button class="hamburger-menu" id="hamburger-menu">
    <i class="fas fa-bars"></i>
  </button>

  <div class="sidebar" id="sidebar">
    <button class="sidebar-toggle-btn" id="sidebar-toggle-btn">
      <i class="fas fa-chevron-left"></i>
    </button>

    <h2><span class="sidebar-title-text">Power BI </span></h2>

    <!-- Link de In√≠cio Power BI -->
    <a href="index.html"><i class="fas fa-home"></i> <span>In√≠cio Power BI</span></a>
    <a href="Introducao_BI_e_Power_BI.html"><i class="fas fa-rocket"></i> <span>Aula 1: Intro BI</span></a>
    <a href="Aula_02_Modelagem.html"><i class="fas fa-project-diagram"></i>
      <span>Aula 2: Modelagem</span></a>
    <a href="Aula_03_Criacao_Relacionamento.html"><i class="fas fa-sitemap"></i> <span>Aula 3:
        Relacionamentos</span></a>
    <a href="Aula_04_Acrescentar_Consultas.html" class="active"><i class="fas fa-layer-group"></i>
      <span>Aula 4: Acrescentar Consultas</span></a>
    <a href="Aula_05_Calendario.html"><i class="fas fa-calendar-alt"></i>
      <span>Aula 5: Tabela Calend√°rio</span></a>
    <a href="Aula_06_Resolucao_Exercicio_Funcionario.html" ><i class="fas fa-chart-line"></i> <span>Aula 6: Resolu√ß√£o Ex√©rc√≠cio Funcionarios</span></a>
    <a href="Aula_07_Gr√°ficos de Vendas e Introdu√ß√£o ao DAX.html" ><i class="fas fa-chart-line"></i> <span>Aula 7: Gr√°ficos de Vendas e Introdu√ß√£o ao DAX</span></a>
  </div>

  <main class="content" id="content">
    <header>
      <h1>Aula 4: Importando e Preparando a Base de Vendas 2020</h1>
      <p>
        Hoje vamos revisar conceitos fundamentais e avan√ßar na constru√ß√£o do
        nosso modelo, come√ßando a trabalhar com a tabela mais importante de um
        projeto de BI: a <strong>Tabela Fato de Vendas</strong>.
      </p>
    </header>

    <section class="main-section">
      <!-- PENSAMENTO DO DIA -->
      <blockquote class="thought-of-the-day">
        <p>"Carregando cita√ß√£o..."</p>
        <cite>‚Äî</cite>
      </blockquote>

      <!-- REVIS√ÉO DA AULA ANTERIOR -->
      <section class="sub-section" style="border-left-color: var(--cor-borda-verde)">
        <h2>
          1Ô∏è‚É£ Revis√£o Completa da Aula Passada <i class="fas fa-undo-alt"></i>
        </h2>

        <p>
          Antes de come√ßarmos a trabalhar com a Base de Vendas 2020, vamos
          revisar os conceitos mais importantes da aula anterior. Essa revis√£o
          √© essencial, pois serve como base para todo o processo de modelagem
          e integra√ß√£o das tabelas de vendas.
        </p>

        <div class="card">
          <h4>üîπ 1. Diferen√ßa entre Tabelas Dimens√£o e Tabelas Fato</h4>
          <p>
            No nosso projeto de BI, existem dois tipos principais de tabelas:
          </p>
          <ul>
            <li>
              <strong>Dimens√£o (d)</strong> ‚Äî S√£o tabelas descritivas. Elas
              explicam o ‚Äúquem‚Äù, ‚Äúo qu√™‚Äù, ‚Äúonde‚Äù, ‚Äúquando‚Äù e ‚Äúcomo‚Äù.
              <br />Exemplos: <strong>dClientes</strong>,
              <strong>dProdutos</strong>, <strong>dLojas</strong>,
              <strong>dLocalidades</strong>.
            </li>
            <li>
              <strong>Fato (f)</strong> ‚Äî S√£o tabelas que registram
              acontecimentos reais que podem ser medidos. <br />Exemplo:
              <strong>fVendas</strong>: cada linha representa uma venda.
            </li>
          </ul>

          <p>
            Essa separa√ß√£o √© fundamental para criarmos um modelo limpo, r√°pido
            e profissional ‚Äî o famoso <strong>Esquema Estrela</strong>.
          </p>
        </div>

        <div class="card">
          <h4>üîπ 2. Tratamentos e Limpezas no Power Query</h4>
          <p>
            Na aula anterior voc√™ aprendeu v√°rias t√©cnicas de padroniza√ß√£o e
            corre√ß√£o:
          </p>
          <ul>
            <li>
              <strong>Padronizar textos</strong> (min√∫sculas, primeiras letras
              mai√∫sculas, remover espa√ßos).
            </li>
            <li>
              <strong>Corrigir tipos de dados</strong> ‚Äî datas, n√∫meros
              decimais, textos, identificadores.
            </li>
            <li>
              <strong>Corrigir problemas de origem</strong> ‚Äî arquivos
              movidos, erros de convers√£o, colunas com erros.
            </li>
            <li>
              <strong>Usar ‚ÄúColuna de Exemplos‚Äù</strong> ‚Äî para criar colunas
              derivadas de forma inteligente.
            </li>
          </ul>

          <p>
            Essa etapa de limpeza garante que o modelo funcione perfeitamente
            e que os dados sejam confi√°veis.
          </p>
        </div>

        <div class="card">
          <h4>üîπ 3. Mesclagem de Consultas (JOIN)</h4>
          <p>
            Tamb√©m aprendemos a usar o recurso
            <strong>Mesclar Consultas</strong>, que permite unir duas tabelas
            trazendo colunas de uma para outra. Por exemplo:
          </p>
          <p>
            Unir <strong>fVendas</strong> com <strong>dProdutos</strong> para
            trazer o nome, marca e pre√ßo unit√°rio.
          </p>

          <p>Isso funciona assim:</p>
          <ul>
            <li>Escolhemos as duas tabelas.</li>
            <li>
              Selecionamos a coluna em comum ‚Äî no caso, o
              <strong>SKU</strong>.
            </li>
            <li>
              Selecionamos quais colunas queremos trazer para a tabela fato.
            </li>
          </ul>

          <p>
            Esse processo √© semelhante ao <strong>JOIN do SQL</strong>, e √©
            √∫til quando precisamos trabalhar com colunas derivadas dentro do
            Power Query.
          </p>
        </div>

        <div class="card">
          <h4>üîπ 4. Relacionamentos</h4>
          <p>
            Os relacionamentos s√£o o ‚Äúc√©rebro‚Äù do modelo. Eles permitem que as
            tabelas conversem entre si sem duplicar dados.
          </p>

          <p>Aprendemos que:</p>
          <ul>
            <li>A tabela dimens√£o filtra a tabela fato.</li>
            <li>
              Isso acontece gra√ßas ao conceito de
              <strong>direcionalidade</strong> (1 ‚Üí *)
            </li>
            <li>
              √â assim que conseguimos montar gr√°ficos usando campos de tabelas
              diferentes.
            </li>
          </ul>

          <blockquote>
            <p>
              <strong>Mesclar junta colunas.</strong><br />
              <strong>Relacionamento conecta tabelas sem duplica√ß√£o.</strong>
            </p>
          </blockquote>

          <p>
            Esse conceito ser√° fundamental para o que faremos agora com a
            Tabela de Vendas.
          </p>
        </div>

        <div class="card">
          <h4>üîπ 5. Por que essa revis√£o √© importante para a Aula 4?</h4>
          <p>
            Agora vamos trabalhar com tr√™s bases de vendas (2020, 2021 e 2022)
            e aprender a:
          </p>
          <ul>
            <li>
              <strong>Unir tabelas</strong> usando Acrescentar Consultas
              (Append)
            </li>
            <li><strong>Entender quando faz sentido juntar bases</strong></li>
            <li>
              <strong>Evitar erros comuns</strong> ao excluir consultas
              utilizadas como fonte
            </li>
            <li><strong>Montar uma √∫nica tabela fato consistente</strong></li>
          </ul>

          <p>
            Sem os conceitos da aula passada, seria imposs√≠vel entender o
            motivo de juntar bases ou como tratar cada ano corretamente.
          </p>
        </div>
      </section>

      <!-- IMPORTAR BASE VENDAS -->
      <section class="sub-section">
        <h2>
          2Ô∏è‚É£ Importando a Tabela Fato: Base Vendas 2020
          <i class="fas fa-file-excel"></i>
        </h2>

        <div class="card">
          <h4>O que √© essa tabela?</h4>
          <p>
            A Base de Vendas cont√©m todos os registros de vendas realizadas no
            ano de <strong>2020</strong>. Cada linha representa uma venda
            individual.
          </p>

          <p>Normalmente, em uma tabela de vendas voc√™ encontra:</p>
          <ul>
            <li>ID da venda</li>
            <li>Data da venda</li>
            <li>SKU (c√≥digo do produto vendido)</li>
            <li>ID da loja</li>
            <li>Quantidade vendida</li>
            <li>Valor total</li>
            <li>Forma de pagamento</li>
          </ul>

          <p>
            Essas informa√ß√µes s√£o essenciais para nossas m√©tricas futuras:
            faturamento, ticket m√©dio, an√°lise por produto, por loja, por
            per√≠odo etc.
          </p>
        </div>

        <div class="card">
          <h4>Importando a base</h4>
          <p>No Power BI:</p>
          <ol>
            <li>
              Acesse <strong>P√°gina Inicial ‚Üí Obter Dados ‚Üí Excel</strong>.
            </li>
            <li>
              Selecione o arquivo <strong>"Base Vendas - 2020.xlsx"</strong>.
            </li>
            <li>No Navegador, selecione a aba com os dados.</li>
            <li>
              Clique em <strong>Transformar Dados</strong> (n√£o carregue
              direto).
            </li>
          </ol>
          <blockquote class="note">
            <p>
              No Power Query, renomeie a tabela para
              <strong>fVendas2020</strong> (prefixo ‚Äúf‚Äù = tabela fato).
            </p>
          </blockquote>
        </div>
      </section>

      <!-- AJUSTES POWER QUERY -->
      <section class="sub-section">
        <h2>
          3Ô∏è‚É£ Principais Ajustes Necess√°rios no Power Query
          <i class="fas fa-wrench"></i>
        </h2>

        <div class="card">
          <h4>O que corrigimos?</h4>
          <p>
            Como a base veio de uma opera√ß√£o real, podem existir
            inconsist√™ncias:
          </p>
          <ul>
            <li>Tipos de dados incorretos</li>
            <li>Datas em formato errado</li>
            <li>Colunas desnecess√°rias</li>
            <li>Campos com texto sujo ou espa√ßos extras</li>
          </ul>
        </div>

        <div class="card">
          <h4>O Problema do SKU</h4>
          <p>
            Na tabela de vendas, temos uma coluna chamada
            <strong>SKU</strong> ‚Äî o c√≥digo do produto vendido. Mas‚Ä¶
          </p>

          <blockquote>
            <p>
              <strong>N√£o sabemos nada sobre esse produto na tabela de
                vendas.</strong>
            </p>
          </blockquote>

          <p>
            Para saber <strong>que produto √© esse</strong>, qual o nome,
            marca, categoria ou pre√ßo unit√°rio, precisamos buscar essas
            informa√ß√µes em outra tabela: a <strong>dProdutos</strong>.
          </p>
        </div>
      </section>

      <!-- MESCLAR CONSULTAS -->
      <section class="sub-section">
        <h2>
          4Ô∏è‚É£ Mesclando Consultas: Trazendo Informa√ß√µes do Produto
          <i class="fas fa-link"></i>
        </h2>

        <div class="card">
          <h4>Por que mesclar?</h4>
          <p>
            A Mesclagem permite juntar duas tabelas em uma √∫nica, trazendo
            colunas da dimens√£o diretamente para a tabela fato.
          </p>

          <p>√â como fazer um <strong>JOIN</strong> em SQL.</p>
        </div>

        <div class="card">
          <h4>Passo a Passo</h4>
          <ol>
            <li>
              No Power Query, selecione a tabela <strong>fVendas2020</strong>.
            </li>
            <li>
              V√° em <strong>P√°gina Inicial ‚Üí Mesclar Consultas</strong>.
            </li>
            <li>
              Na janela que abrir:
              <ul>
                <li>Tabela de cima: <strong>fVendas2020</strong></li>
                <li>Tabela de baixo: <strong>dProdutos</strong></li>
                <li>Coluna de liga√ß√£o em ambas: <strong>SKU</strong></li>
              </ul>
            </li>
          </ol>

          <img src="img/Mesclar Consultas - BaseVendas2020 - CadastroProdutos.png" class="screenshot" />
        </div>

        <div class="card">
          <h4>Selecionando as colunas da dimens√£o</h4>
          <p>
            Ap√≥s mesclar, clique no bot√£o de expans√£o da nova coluna e
            selecione apenas:
          </p>
          <ul>
            <li>Nome do Produto</li>
            <li>Marca</li>
            <li>Pre√ßo Unit√°rio</li>
          </ul>

          <img src="img/Selecionar colunas CadastroProduto - Mesclar tabelas.png" class="screenshot" />
          <p>
            Desmarque a op√ß√£o
            <strong>‚ÄúUsar nome de coluna original como prefixo‚Äù</strong>.
          </p>
        </div>

        <div class="card">
          <h4>Validando os produtos</h4>
          <p>Ap√≥s expandir as informa√ß√µes, valide alguns registros:</p>
          <ul>
            <li>O pre√ßo unit√°rio est√° correto?</li>
            <li>A marca corresponde ao SKU?</li>
            <li>O nome do produto faz sentido?</li>
          </ul>
        </div>
      </section>

      <!-- RELACIONAMENTO VS MESCLAGEM -->
      <section class="sub-section" style="border-left-color: var(--cor-borda-vermelho)">
        <h2>
          5Ô∏è‚É£ Mesclar vs. Relacionamentos <i class="fas fa-balance-scale"></i>
        </h2>

        <div class="card">
          <h4>Existe outro caminho‚Ä¶</h4>
          <p>
            Sim! A mesma informa√ß√£o poderia chegar no relat√≥rio
            <strong>sem mesclar</strong>, apenas usando
            <strong>relacionamentos</strong>.
          </p>
        </div>

        <div class="card">
          <h4>Por que relacionamento √© melhor?</h4>
          <ul>
            <li>Economiza mem√≥ria ‚Äî a tabela fato continua leve.</li>
            <li>Evita duplica√ß√£o de dados.</li>
            <li>Aumenta performance.</li>
            <li>O modelo fica mais organizado (Esquema Estrela).</li>
          </ul>
          <blockquote>
            <p>
              A mesclagem repete informa√ß√µes linha por linha. O relacionamento
              conecta as tabelas sem duplicar nada.
            </p>
          </blockquote>
        </div>

        <div class="card">
          <h4>Quando mesclar, ent√£o?</h4>
          <ul>
            <li>
              Quando a an√°lise exige c√°lculos linha a linha diretamente na
              tabela fato.
            </li>
            <li>
              Quando o dado da dimens√£o precisa participar de transforma√ß√µes
              no Power Query.
            </li>
            <li>
              Quando n√£o existe uma chave confi√°vel para o relacionamento.
            </li>
          </ul>
        </div>

        <div class="card">
          <h4>‚ÄúPor que n√£o vem tudo junto?‚Äù</h4>
          <p>
            Porque separar dimens√µes das tabelas fato √© um padr√£o
            internacional chamado <strong>Modelagem Dimensional</strong>.
          </p>

          <p>As vantagens incluem:</p>
          <ul>
            <li>Menor ocupa√ß√£o de mem√≥ria</li>
            <li>Melhor compress√£o de dados (VertiPaq)</li>
            <li>Maior velocidade nas consultas</li>
            <li>Relat√≥rios mais flex√≠veis</li>
          </ul>
        </div>

        <div class="card">
          <h4>Limpando a tabela caso tenhamos mesclado</h4>
          <p>
            Se voc√™ preferir seguir o m√©todo ideal (relacionamento), basta:
          </p>
          <ul>
            <li>Excluir as colunas trazidas pela mesclagem, ou</li>
            <li>
              Excluir a etapa inteira da mesclagem no painel ‚ÄúEtapas
              Aplicadas‚Äù.
            </li>
          </ul>
        </div>
      </section>

      <section class="sub-section">
        <h2>
          6Ô∏è‚É£ Unindo as Vendas dos Anos: Acrescentar Consultas (APPEND)
          <i class="fas fa-layer-group"></i>
        </h2>

        <div class="card">
          <h4>Por que juntar as tabelas de vendas?</h4>
          <p>
            Temos tr√™s arquivos: <strong>Vendas 2020</strong>,
            <strong>Vendas 2021</strong> e <strong>Vendas 2022</strong>.
          </p>
          <p>
            Se deixarmos cada ano como uma tabela separada, at√© funciona‚Ä¶ mas
            ser√° muito mais trabalhoso:
          </p>
          <ul>
            <li>Ter√≠amos que criar medidas para cada tabela.</li>
            <li>Ter√≠amos que repetir DAX para 2020, 2021 e 2022.</li>
            <li>Ter√≠amos gr√°ficos duplicados ou filtros limitados.</li>
            <li>Geraria confus√£o no modelo e polui√ß√£o visual.</li>
          </ul>

          <blockquote>
            <p>
              <strong>Objetivo ideal:</strong> ter
              <strong>uma √∫nica tabela de vendas</strong> com todos os anos
              juntos.
            </p>
          </blockquote>
        </div>

        <div class="card">
          <h4>Importando as tabelas de 2021 e 2022</h4>
          <p>No Power Query, clique em:</p>
          <ol>
            <li><strong>Novo Fonte ‚Üí Excel</strong>.</li>
            <li>Selecione <strong>"Base Vendas - 2021.xlsx"</strong>.</li>
            <li>
              Depois, repita para <strong>"Base Vendas - 2022.xlsx"</strong>.
            </li>
          </ol>

          <p>Aqui surge algo curioso:</p>

          <blockquote class="note">
            <p>
              <strong>N√£o aparece a op√ß√£o "Transformar Dados".</strong><br />
              Isso acontece porque voc√™ j√° est√° dentro do Power Query. Como
              voc√™ j√° est√° no ambiente de transforma√ß√£o, ele s√≥ mostra o bot√£o
              <strong>OK</strong>.
            </p>
          </blockquote>
        </div>

        <div class="card">
          <h4>
            Agora sim: Vamos somar todas as bases usando "Acrescentar
            Consultas"
          </h4>

          <p>Na parte superior do Power Query, v√° para:</p>

          <p>
            <strong>P√°gina Inicial ‚Üí Combinar ‚Üí Acrescentar Consultas</strong>
          </p>

          <p>
            √â a ferramenta que ‚Äúempilha‚Äù tabelas ‚Äî diferentemente de Mesclar,
            que adiciona colunas.
          </p>

          <img src="img/Acrescentar Consultas.png" class="screenshot" />

          <p>Existem duas op√ß√µes:</p>
          <ul>
            <li>
              <strong>Acrescentar Consultas</strong> ‚Äì adiciona dados dentro
              da tabela selecionada.
            </li>
            <li>
              <strong>Acrescentar Consultas como Nova</strong> ‚Äì cria uma nova
              tabela com o resultado da soma.
            </li>
          </ul>

          <blockquote>
            <p>
              <strong>Para nosso caso:</strong> vamos usar
              <strong>Acrescentar Consultas como Nova</strong>.
            </p>
          </blockquote>
        </div>

        <div class="card">
          <h4>A tela de Acrescentar Consultas</h4>

          <p>
            A tela que aparece permite escolher quais tabelas ser√£o
            empilhadas:
          </p>

          <img src="img/Tela Acrescentar.png" class="screenshot" />

          <p>Configure assim:</p>
          <ol>
            <li>No topo, selecione <strong>Tr√™s ou mais tabelas</strong>.</li>
            <li>
              Adicione na ordem:
              <ul>
                <li>fVendas2020</li>
                <li>fVendas2021</li>
                <li>fVendas2022</li>
              </ul>
            </li>
            <li>
              Se colocou na ordem errada, use as setas para reorganizar.
            </li>
            <li>Clique em <strong>OK</strong>.</li>
          </ol>
        </div>

        <div class="card">
          <h4>Renomeando a tabela unificada</h4>
          <p>Uma nova consulta aparece. Renomeie para:</p>

          <blockquote><strong>fBaseVendas</strong></blockquote>
        </div>
      </section>

      <section class="sub-section">
        <h2>
          7Ô∏è‚É£ Posso excluir as tabelas separadas?
          <i class="fas fa-trash-alt"></i>
        </h2>

        <div class="card">
          <h4>Tentando excluir as tabelas 2020, 2021 e 2022‚Ä¶</h4>
          <p>
            Quando voc√™ tenta excluir as consultas antigas
            (<strong>fVendas2020</strong>, <strong>fVendas2021</strong>,
            <strong>fVendas2022</strong>), o Power Query d√° erro.
          </p>

          <blockquote>
            <p><strong>Mas por que n√£o deixa excluir?</strong></p>
          </blockquote>

          <p>
            Porque a consulta <strong>fBaseVendas</strong> DEPENDE delas. Elas
            s√£o as fontes usadas no ‚ÄúAcrescentar Consultas‚Äù.
          </p>

          <p>
            Se excluir, o Power Query n√£o saber√° mais de onde viram os dados.
          </p>
        </div>

        <div class="card">
          <h4>Ent√£o o que fazer?</h4>

          <p>
            Simples: vamos deixar as tabelas existirem, mas
            <strong>sem carregar para o modelo</strong>.
          </p>

          <p>No lado direito, clique com bot√£o direito em cada tabela e:</p>

          <p><strong>Desmarque ‚ÄúHabilitar Carga‚Äù.</strong></p>

          <blockquote class="note">
            <p>
              Assim, elas continuam existindo como ‚Äúapoio‚Äù para o Power Query,
              mas n√£o ocupam espa√ßo no modelo.
            </p>
          </blockquote>
        </div>
      </section>

      <section class="sub-section">
        <h2>
          8Ô∏è‚É£ E se amanh√£ chegar uma nova base, como Vendas 2023?
          <i class="fas fa-calendar-plus"></i>
        </h2>

        <div class="card">
          <h4>Preciso refazer tudo?</h4>
          <p>
            <strong>N√£o!</strong> Voc√™ n√£o precisa recriar nada nem excluir
            tabelas.
          </p>

          <p>Basta seguir estes passos:</p>
          <ol>
            <li>
              Importar a nova tabela (ex.:
              <strong>Base Vendas - 2023.xlsx</strong>).
            </li>
            <li>Criar a consulta <strong>fVendas2023</strong>.</li>
            <li>
              Ir em:
              <ul>
                <li><strong>Combinar ‚Üí Acrescentar Consultas</strong></li>
              </ul>
            </li>
            <li>
              Desta vez N√ÉO ser√° ‚Äúcomo nova‚Äù. Ser√° apenas:
              <blockquote><strong>Acrescentar Consultas</strong></blockquote>
            </li>
            <li>
              Selecione:
              <ul>
                <li><strong>fBaseVendas</strong> (a tabela principal)</li>
                <li><strong>fVendas2023</strong> (nova tabela)</li>
              </ul>
            </li>
          </ol>

          <p>
            Pronto! Agora sua tabela principal est√° atualizada com quatro
            anos.
          </p>
        </div>

        <div class="card">
          <h4>Validando os resultados</h4>
          <p>No Power BI (modo Relat√≥rio):</p>
          <ol>
            <li>V√° para a visualiza√ß√£o de dados (√≠cone de tabela).</li>
            <li>Selecione <strong>fBaseVendas</strong>.</li>
            <li>Clique em ‚ÄúData da Venda‚Äù.</li>
            <li>Ordene por data (clicando no cabe√ßalho).</li>
          </ol>

          <p>
            Agora voc√™ ver√° registros de 2020, 2021, 2022 ‚Äî e, caso exista,
            2023.
          </p>
        </div>
      </section>

      <section class="sub-section">
        <h2>
          9Ô∏è‚É£ Importando Dados de uma Pasta: Automa√ß√£o de Bases Anuais
          <i class="fas fa-folder-open"></i>
        </h2>

        <div class="card">
          <h4>Por que importar de uma pasta?</h4>
          <p>
            At√© agora, importamos cada base de vendas (2020, 2021, 2022)
            manualmente. Isso funciona, mas n√£o escala bem. Sempre que chegar
            um novo arquivo (ex: <strong>Base Vendas - 2023.xlsx</strong>),
            ter√≠amos que repetir parte do trabalho.
          </p>
          <p>
            A abordagem profissional √© usar a op√ß√£o
            <strong>‚ÄúPasta‚Äù</strong> no Power Query. Assim, o Power BI passa a
            ler todos os arquivos de uma pasta de forma din√¢mica, atualizando
            automaticamente quando novos arquivos forem adicionados.
          </p>
          <blockquote class="note">
            <p>
              <strong>Ideia central:</strong> em vez de conectar em v√°rios
              arquivos, conectamos em uma <strong>pasta</strong> e deixamos o
              Power Query cuidar do restante.
            </p>
          </blockquote>
        </div>

        <div class="card">
          <h4>Preparando o terreno: limpando as consultas antigas</h4>
          <p>
            Antes de importar pela pasta, vamos remover as consultas de vendas
            que criamos manualmente:
          </p>
          <ul>
            <li><strong>fVendas2020</strong></li>
            <li><strong>fVendas2021</strong></li>
            <li><strong>fVendas2022</strong></li>
            <li><strong>fBaseVendas</strong> (caso ainda exista)</li>
          </ul>
          <p>Voc√™ pode excluir assim:</p>
          <ul>
            <li>
              Selecionando <strong>fBaseVendas</strong> primeiro e depois as
              demais, e deletando.
            </li>
            <li>
              Ou segurando <strong>Ctrl</strong>, selecionando todas as
              consultas de vendas e excluindo de uma vez.
            </li>
          </ul>
          <p>
            Como nenhuma consulta est√° sendo usada por outra (neste momento),
            a exclus√£o √© permitida.
          </p>
        </div>

        <div class="card">
          <h4>Importando os arquivos pela op√ß√£o ‚ÄúPasta‚Äù</h4>
          <p>No Power BI Desktop, fa√ßa o seguinte:</p>
          <ol>
            <li>
              Na guia <strong>P√°gina Inicial</strong>, clique em
              <strong>Obter Dados</strong> ‚Üí <strong>Mais...</strong>.
            </li>
            <li>Procure e selecione a op√ß√£o <strong>Pasta</strong>.</li>
            <li>
              Escolha a pasta onde est√£o salvos os arquivos de vendas (Base
              Vendas - 2020, 2021, 2022 e assim por diante).
            </li>
          </ol>
          <p>
            Ao confirmar, o Power Query exibir√° uma nova janela mostrando
            todos os arquivos daquela pasta.
          </p>
          <img src="img/Importar arquivos da pasta.png"
            alt="Janela mostrando os arquivos de uma pasta para importa√ß√£o no Power BI" class="screenshot" />
        </div>

        <div class="card">
          <h4>A nova consulta criada a partir da pasta</h4>
          <p>
            Ao clicar em <strong>Transformar Dados</strong>, o Power Query
            criar√° uma nova consulta com o nome da pasta (por exemplo:
            <strong>documentos</strong>).
          </p>
          <p>
            Nessa consulta, teremos uma tabela com uma linha para cada arquivo
            encontrado na pasta, com colunas como:
          </p>
          <ul>
            <li><strong>Name</strong> ‚Äì nome do arquivo</li>
            <li><strong>Extension</strong> ‚Äì extens√£o (.xlsx, .csv etc.)</li>
            <li><strong>Folder Path</strong> ‚Äì caminho da pasta</li>
            <li><strong>Content</strong> ‚Äì conte√∫do bin√°rio do arquivo</li>
          </ul>
          <img src="img/importa√ß√£o de pasta 1.png"
            alt="Tabela gerada a partir da importa√ß√£o da pasta, listando todos os arquivos" class="screenshot" />
        </div>

        <div class="card">
          <h4>Primeira ideia: filtrar manualmente os arquivos de vendas</h4>
          <p>
            A primeira rea√ß√£o natural seria ir at√© a coluna
            <strong>Name</strong>, abrir o filtro e marcar apenas:
          </p>
          <ul>
            <li><strong>Base Vendas - 2020.xlsx</strong></li>
            <li><strong>Base Vendas - 2021.xlsx</strong></li>
            <li><strong>Base Vendas - 2022.xlsx</strong></li>
          </ul>
          <p>
            Isso at√© funciona, mas tem um grande problema: quando chegar a
            <strong>Base Vendas - 2023.xlsx</strong>, ter√≠amos que voltar ao
            Power Query e editar o filtro manualmente.
          </p>
          <blockquote>
            <p>
              <strong>Objetivo:</strong> criar um filtro din√¢mico, que
              funcione para os arquivos atuais e para os que ainda v√£o surgir.
            </p>
          </blockquote>
        </div>

        <div class="card">
          <h4>Filtro din√¢mico com ‚ÄúCome√ßa com‚Äù</h4>
          <p>
            Vamos excluir a etapa de filtro anterior (caso tenha sido criada)
            e refazer de maneira mais inteligente.
          </p>
          <ol>
            <li>Clique na seta de filtro da coluna <strong>Name</strong>.</li>
            <li>V√° at√© <strong>Filtros de Texto</strong>.</li>
            <li>Selecione a op√ß√£o <strong>Come√ßa com...</strong>.</li>
          </ol>
          <img src="img/Filtros de texto.png" alt="Menu de filtros de texto na coluna Name" class="screenshot" />
          <p>Na janela que abrir, preencha o campo com o texto:</p>
          <pre><code>Base Vendas -</code></pre>
          <img src="img/Filtrar Linhas.png" alt="Tela de filtro de linhas configurando 'Come√ßa com Base Vendas -'"
            class="screenshot" />
          <p>
            Agora o Power Query vai trazer
            <strong>todos os arquivos</strong> cujo nome come√ßa com
            <strong>"Base Vendas -"</strong>, incluindo futuras bases como
            2023, 2024, etc., desde que sigam o mesmo padr√£o de nome.
          </p>
          <blockquote class="lesson-learned">
            <p>
              <strong>Li√ß√£o:</strong> processos profissionais de ETL dependem
              de <strong>padr√µes</strong>. Sem padr√£o no nome dos arquivos,
              fica imposs√≠vel automatizar.
            </p>
          </blockquote>
        </div>

        <div class="card">
          <h4>Combinando os arquivos filtrados</h4>
          <p>
            Com o filtro configurado, vamos abrir o conte√∫do dessas tabelas.
            Na coluna <strong>Content</strong>, clique no √≠cone √† direita em
            <strong>‚ÄúCombinar Arquivos‚Äù</strong>.
          </p>
          <p>
            Para que essa combina√ß√£o funcione corretamente, os arquivos
            precisam ser:
          </p>
          <ul>
            <li>Similares em estrutura.</li>
            <li>Com a mesma ordem de colunas.</li>
            <li>Com os mesmos nomes de colunas.</li>
            <li>
              Com o mesmo nome de aba interna (no nosso caso,
              <strong>Plan1</strong>).
            </li>
          </ul>
          <img src="img/Combinar Arquivos.png" alt="Tela de Combinar Arquivos no Power Query" class="screenshot" />
          <p>
            O Power Query tamb√©m pedir√° um
            <strong>arquivo de amostra</strong>. Escolha, por exemplo, a base
            de 2020.
          </p>
          <blockquote class="note">
            <p>
              O arquivo de amostra serve para o Power Query entender a
              estrutura da tabela (colunas, tipos de dados, aba etc.) e
              aplicar o mesmo padr√£o aos demais arquivos.
            </p>
          </blockquote>
        </div>

        <div class="card">
          <h4>Conferindo se todos os anos foram carregados</h4>
          <p>
            Depois de combinar os arquivos, teremos uma tabela unificada com
            as vendas. Para verificar se todos os anos foram inclu√≠dos:
          </p>
          <ol>
            <li>Localize a coluna <strong>Data da Venda</strong>.</li>
            <li>Abra o filtro dela e pesquise por <strong>2021</strong>.</li>
          </ol>
          <img src="img/filtro data venda 2021 sem carregar mais.png"
            alt="Filtro da Data da Venda sem mostrar 2021 antes de carregar mais" class="screenshot" />
          <p>
            Se o ano n√£o aparecer, isso n√£o significa que os dados n√£o foram
            importados. Em muitos casos, o Power BI est√° mostrando apenas uma
            amostra das datas.
          </p>
          <p>
            Nesse caso, clique em <strong>‚ÄúCarregar mais‚Äù</strong> (acima dos
            bot√µes OK e Cancelar) e tente filtrar novamente. Agora os anos
            2020, 2021 e 2022 dever√£o aparecer normalmente.
          </p>
        </div>

        <div class="card">
          <h4>Consultas auxiliares criadas automaticamente</h4>
          <p>
            Ao lado esquerdo, na lista de consultas, o Power Query cria
            algumas consultas auxiliares, como:
          </p>
          <ul>
            <li><strong>Exemplo de Arquivo</strong></li>
            <li><strong>Transforma√ß√£o de Arquivos</strong></li>
            <li><strong>Transforma√ß√£o de Arquivos (2)</strong></li>
            <li>Pastas agrupando essas consultas</li>
          </ul>
          <img src="img/Consultas auxiliares.png"
            alt="Consultas auxiliares criadas automaticamente pelo Power Query na combina√ß√£o de arquivos"
            class="screenshot" />
          <p>
            Essas consultas s√£o usadas internamente para aplicar as
            transforma√ß√µes em todos os arquivos. Voc√™ n√£o precisa editar nada
            nelas.
          </p>
          <p>
            Se quiser, pode minimizar/ocultar essas pastas para manter o
            painel de consultas visualmente mais limpo.
          </p>
        </div>

        <div class="card">
          <h4>Renomeando a tabela final e testando a automa√ß√£o</h4>
          <p>
            Por fim, renomeie a tabela resultante da combina√ß√£o para um nome
            mais claro, por exemplo:
          </p>
          <pre><code>fBaseVendas</code></pre>
          <p>Agora vamos testar se o processo √© realmente autom√°tico:</p>
          <ol>
            <li>
              Na pasta do Windows, duplique o arquivo
              <strong>"Base Vendas - 2022.xlsx"</strong>.
            </li>
            <li>
              Renomeie a c√≥pia para
              <strong>"Base Vendas - 2023.xlsx"</strong>.
            </li>
            <li>
              Abra o arquivo e, na coluna <strong>Data da Venda</strong>,
              substitua o ano de 2022 para 2023.
            </li>
            <li>Salve e feche o arquivo.</li>
            <li>
              De volta ao Power BI, clique em <strong>Atualizar</strong>.
            </li>
          </ol>
          <p>
            Depois da atualiza√ß√£o, verifique em
            <strong>fBaseVendas</strong> se o ano de 2023 aparece no filtro de
            datas e se a quantidade de registros aumentou.
          </p>
          <blockquote class="lesson-learned">
            <p>
              <strong>Conclus√£o:</strong> sempre que voc√™ adicionar um novo
              arquivo de vendas na pasta, seguindo o padr√£o de nome ‚ÄúBase
              Vendas - AAAA.xlsx‚Äù, o Power BI vai integr√°-lo automaticamente √†
              tabela <strong>fBaseVendas</strong>.
            </p>
          </blockquote>
        </div>
      </section>

      <section class="sub-section">
        <h2>
          üîü Atividade: Preparando-se para a Aula 5 (Calend√°rio)
          <i class="fas fa-calendar-alt"></i>
        </h2>

        <div class="card">
          <h4>Objetivo da atividade</h4>
          <p>
            Consolidar o que vimos sobre importa√ß√£o, combina√ß√£o de bases e
            modelagem, e preparar o terreno para o pr√≥ximo assunto
            fundamental: a <strong>Tabela Calend√°rio</strong>.
          </p>
        </div>

        <div class="card">
          <h4>Passo a passo</h4>
          <ol>
            <li>
              Abra o arquivo do seu projeto no Power BI e confirme que voc√™
              tem:
              <ul>
                <li>
                  A tabela <strong>fBaseVendas</strong> com todas as vendas de
                  2020 a 2022 (e 2023, se voc√™ adicionou).
                </li>
                <li>
                  As dimens√µes <strong>dClientes</strong>,
                  <strong>dProdutos</strong> e <strong>dLojas</strong> j√°
                  tratadas.
                </li>
              </ul>
            </li>
            <li>
              Na guia Relat√≥rio, crie um visual de
              <strong>tabela</strong> mostrando:
              <ul>
                <li><strong>Data da Venda</strong></li>
                <li>
                  <strong>Quantidade</strong> (ou outra m√©trica de volume de
                  vendas)
                </li>
                <li>
                  <strong>Valor Total</strong> (se voc√™ j√° tiver criado essa
                  medida ou coluna).
                </li>
              </ul>
            </li>
            <li>
              Em um caderno, arquivo Word, Notion ou OneNote, responda:
              <ul>
                <li>
                  Qual √© a <strong>data mais antiga</strong> e a
                  <strong>data mais recente</strong> na tabela
                  <strong>fBaseVendas</strong>?
                </li>
                <li>
                  Voc√™ consegue facilmente criar:
                  <ul>
                    <li>Um gr√°fico de vendas por <strong>ano</strong>?</li>
                    <li>Um gr√°fico de vendas por <strong>m√™s</strong>?</li>
                    <li>
                      Um gr√°fico de vendas por <strong>dia da semana</strong>?
                    </li>
                  </ul>
                </li>
                <li>
                  O que voc√™ acha que est√° faltando no modelo para facilitar
                  esse tipo de an√°lise de tempo?
                </li>
              </ul>
            </li>
            <li>
              Pesquise rapidamente na internet:
              <ul>
                <li><strong>"Tabela Calend√°rio Power BI"</strong></li>
                <li><strong>"Dimens√£o Data"</strong></li>
                <li><strong>"Time Intelligence DAX"</strong></li>
              </ul>
            </li>
            <li>
              Anote, com suas pr√≥prias palavras:
              <ul>
                <li>
                  O que √© uma <strong>Tabela Calend√°rio</strong> ou
                  <strong>Dimens√£o Data</strong>.
                </li>
                <li>
                  Por que a maioria dos modelos profissionais de BI tem uma
                  tabela espec√≠fica de datas.
                </li>
              </ul>
            </li>
          </ol>
        </div>

        <div class="card">
          <h4>Pr√≥ximo passo</h4>
          <p>
            Na <strong>Aula 5</strong>, vamos criar juntos a sua pr√≥pria
            tabela calend√°rio e conectar essa tabela ao modelo. A partir
            disso, an√°lises por ano, m√™s, trimestre, dia da semana e
            compara√ß√µes entre per√≠odos ficar√£o muito mais simples e poderosas.
          </p>
        </div>
      </section>
    </section>
  </main>

  <a href="#" id="back-to-top" class="back-to-top" title="Voltar ao topo">
    <i class="fas fa-chevron-up"></i>
  </a>

  <script src="js/quotes.js"></script>
  <script src="js/main.js"></script>
</body>

</html>