<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Aula 2: O Cora√ß√£o do BI - Modelagem de Dados</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
</head>

<body>
  <div class="overlay" id="overlay"></div>

  <button class="hamburger-menu" id="hamburger-menu">
    <i class="fas fa-bars"></i>
  </button>

  <div class="sidebar" id="sidebar">
    <button class="sidebar-toggle-btn" id="sidebar-toggle-btn">
      <i class="fas fa-chevron-left"></i>
    </button>

    <h2><span class="sidebar-title-text">Power BI </span>üìä</h2>

    <a href="index.html"><i class="fas fa-home"></i> <span>In√≠cio Power BI</span></a>
    <a href="Introducao_BI_e_Power_BI.html"><i class="fas fa-rocket"></i> <span>Aula 1: Intro BI</span></a>
    <a href="Aula_02_Modelagem.html" class="active"><i class="fas fa-project-diagram"></i> <span>Aula 2: Modelagem</span></a>
  </div>

  <main class="content" id="content">
    <header>
      <h1>Aula 2: O Cora√ß√£o do BI - Modelagem de Dados</h1>
      <p>Na aula anterior, preparamos nossos dados. Agora, vamos construir as "pontes" entre eles. Bem-vindo √† Modelagem de Dados, a etapa que transforma tabelas soltas em um c√©rebro funcional.</p>
    </header>

    <section class="main-section">

      <blockquote class="thought-of-the-day">
        <p>"Carregando cita√ß√£o..."</p>
        <cite>‚Äî</cite>
      </blockquote>
      
      <section class="sub-section" style="border-left-color: var(--cor-borda-verde);">
        <h2>Revis√£o R√°pida: O que fizemos na Aula 1? <i class="fas fa-clipboard-check"></i></h2>
        <p>Antes de avan√ßarmos, vamos recapitular nossa jornada. Na Aula 1, demos os passos fundamentais de qualquer projeto de BI:</p>
        <div class="card">
            <h4>1. Extra√ß√£o, Transforma√ß√£o e Carga (ETL)</h4>
            <p>N√≥s nos conectamos ao "Cadastro Clientes.xlsx" e "Cadastro Produtos.xlsx", renomeamos as consultas e realizamos a limpeza inicial (linhas/colunas vazias, tipos de dados).</p>
        </div>
        <div class="card">
            <h4>2. O Problema Atual: "Ilhas de Dados"</h4>
            <p>Conclu√≠mos com o desafio: Nossas tabelas (`dClientes` e `dProdutos` - que voc√™ importou no exerc√≠cio final) s√£o como duas "ilhas" separadas. Elas n√£o conversam.</p>
            <p>O objetivo desta Aula 2 √© **preparar a base de dados dos produtos** e, em seguida, **construir as pontes (relacionamentos)** para conectar essas ilhas.</p>
        </div>
      </section>
      
      <section class="sub-section">
        <h2>1Ô∏è‚É£ Preparando a An√°lise: Limpeza em `dClientes` <i class="fas fa-broom"></i></h2>
        <p>Um bom analista de BI nunca confia 100% nos dados brutos. Para garantir que a coluna "G√™nero" estivesse perfeita para a an√°lise, aplicamos a padroniza√ß√£o.</p>
        
        <div class="card">
            <h4>Limpeza Avan√ßada: Substituir Valores (Revis√£o)</h4>
            <p>Ao inspecionar a coluna **"G√™nero"** na tabela `dClientes`, padronizamos varia√ß√µes como "Fem." e "Masc." para **"Feminino"** e **"Masculino"** usando a fun√ß√£o **Substituir Valores**.</p>
            <img src="img/Substituir valores.png" alt="Janela de Substituir Valores no Power Query, mostrando a substitui√ß√£o de 'Masc.' por 'Masculino'." class="screenshot">
            <p>Ap√≥s a substitui√ß√£o, clicamos em <strong>"Fechar e Aplicar"</strong> para carregar as altera√ß√µes.</p>
        </div>
      </section>

      <section class="sub-section">
        <h2>2Ô∏è‚É£ Visualizando o G√™nero e a Prova do ETL <i class="fas fa-chart-pie"></i></h2>
        <p>Com a coluna "G√™nero" limpa, criamos nosso primeiro visual e simulamos a atualiza√ß√£o de dados.</p>
        
        <div class="card">
            <h4>Criando o Gr√°fico de Pizza</h4>
            <p>No **Guia Relat√≥rio** do Power BI, criamos o Gr√°fico de Pizza, arrastando **"G√™nero"** para **Legenda** e a **Contagem** de **"Nome Completo"** para **Valores**.</p>
            <img src="img/pizza genero - count nome completo.png" alt="Gr√°fico de Pizza mostrando a distribui√ß√£o de clientes por G√™nero, usando Contagem de Nome Completo como valor." class="screenshot">
        </div>

        <div class="card">
            <h2><i class="fas fa-redo-alt"></i> A Prova do ETL: Atualiza√ß√£o Din√¢mica de Dados</h2>
            <p>A simula√ß√£o de novos cadastros √© crucial para entender o valor do ETL na vida real. Lembre-se:</p>
            <ol>
                <li>**Inserir Novos Clientes:** Copiamos e colamos novos registros na planilha **"Cadastro Clientes.xlsx"** e salvamos o Excel.</li>
                <li>**Atualizar no Power BI:** Na guia **P√°gina Inicial** do Power BI, clicamos em <strong>"Atualizar"</strong>.</li>
            </ol>
            <p>O Power BI repetiu automaticamente **todos os passos de limpeza** salvos no Power Query (incluindo a padroniza√ß√£o de G√™nero) e atualizou o Cart√£o e o Gr√°fico de Pizza.</p>
            <p style="font-weight: bold; color: var(--cor-borda-verde);">Este √© o valor do ETL: seu projeto est√° vivo e a prova de falhas, pois ele repete a limpeza automaticamente a cada atualiza√ß√£o!</p>
        </div>
      </section>

      <section class="sub-section">
        <h2>3Ô∏è‚É£ Limpando a Tabela Dimens√£o: `dProdutos` <i class="fas fa-box-open"></i></h2>
        <p>Agora vamos garantir que a nossa tabela de produtos esteja perfeita para a Modelagem.</p>
        
        <div class="card">
            <h4>Importa√ß√£o, Nomenclatura e Tratamento Inicial</h4>
            <p>Caso voc√™ n√£o tenha feito o exerc√≠cio da Aula 1, volte ao Power BI Desktop e clique em **"Obter dados"** para importar o arquivo "Cadastro Produtos.xlsx". Clique em **"Transformar Dados"** para abrir o Power Query.</p>
            <img src="img/importar Cadastro de produto.png" alt="Janela do Navegador no Power BI mostrando a sele√ß√£o da planilha 'Cadastro de Produto' antes de clicar em Transformar Dados." class="screenshot">
            <ol>
                <li>Renomeie a consulta para **"dProdutos"**.</li>
                <li><strong>M√∫ltiplas Abas:</strong> Se o arquivo tivesse v√°rias abas e voc√™ as tivesse selecionado, cada uma apareceria como uma tabela separada. Mais √† frente, veremos como **combinar** v√°rios arquivos ou abas de uma s√≥ vez.</li>
                <li><strong>Limpeza Necess√°ria:</strong> Aplique os tratamentos iniciais de rotina: **Remover Linhas** > **Remover Linhas em Branco** e **Promover Cabe√ßalhos**.</li>
            </ol>
        </div>

        <div class="card">
            <h4>Qualidade da Coluna: A Inspe√ß√£o R√°pida <i class="fas fa-eye"></i></h4>
            <p>Para um bom analista, a qualidade do dado √© a prioridade. O Power Query possui um recurso visual para verificar rapidamente a integridade da sua tabela:</p>
            <ul>
                <li>Na guia **Exibi√ß√£o**, marque a op√ß√£o **"Qualidade da Coluna"**.</li>
                <li>Observe os indicadores de **V√°lido**, **Erro** e **Vazio** que aparecem acima de cada cabe√ßalho.
                    <img src="img/Qualidade da Coluna.png" alt="Recurso Qualidade da Coluna no Power Query mostrando a porcentagem de valores v√°lidos, com erro e vazios." class="screenshot">
                </li>
                <li>Sempre fa√ßa essa inspe√ß√£o para verificar se os tipos de dados (o √≠cone ABC, 123) est√£o corretos.</li>
            </ul>
        </div>
      </section>

      <section class="sub-section">
        <h2>4Ô∏è‚É£ Corrigindo o Erro de Decimal (Divis√£o Padr√£o) <i class="fas fa-calculator"></i></h2>
        <p>Vamos resolver o problema da coluna **"Pre√ßo Unit√°rio"** que est√° lendo um valor 100 vezes maior que o real devido √† leitura do ponto decimal no padr√£o brasileiro.</p>

        <div class="card">
            <h4>A Solu√ß√£o de ETL (Dividir por 100)</h4>
            <p>Em vez de corrigir manualmente no Excel, usamos o Power Query para aplicar uma transforma√ß√£o que ser√° repetida sempre:</p>
            <ol>
                <li>Selecione a coluna **"Pre√ßo Unit√°rio"**.</li>
                <li>V√° para a guia **Transformar**.</li>
                <li>No grupo "Coluna de N√∫mero", clique em **Padr√£o** > **Dividir**.
                    <img src="img/ajustar pre√ßo unit√°rio.png" alt="Op√ß√£o Dividir no menu Transformar > Padr√£o do Power Query." class="screenshot">
                </li>
                <li>Na janela, digite **100** e clique em OK.</li>
            </ol>
            <p>Ap√≥s essa etapa, altere o tipo de dados da coluna para **"N√∫mero Decimal Fixo"**. Isso garante que o valor seja `25.95` (no formato brasileiro) e n√£o mais `2595`.</p>

            <blockquote class="lesson-learned">
                <p><strong>A Li√ß√£o do ETL:</strong> Lembre-se: a etapa de "Dividir por 100" est√° salva no Power Query e ser√° aplicada automaticamente, corrigindo o erro de decimal em qualquer atualiza√ß√£o futura.</p>
            </blockquote>
        </div>
      </section>
      
      <section class="sub-section">
        <h2>5Ô∏è‚É£ Separando Informa√ß√µes: Dividir Coluna por Delimitador <i class="fas fa-arrows-alt-h"></i></h2>
        <p>A coluna **Produto** cont√©m o nome do item e sua cor/caracter√≠stica, separados por um tra√ßo. Precisamos dividir essa informa√ß√£o em duas colunas distintas.</p>

        <div class="card">
            <h4>Op√ß√µes de Divis√£o (Transformar)</h4>
            <p>O Power Query oferece v√°rias maneiras de dividir uma coluna, como **Por Delimitador**, **Por N√∫mero de Caracteres** ou **Por Posi√ß√£o**.</p>
            <p>Para a nossa coluna **Produto**, a melhor op√ß√£o √© **Dividir Coluna > Por Delimitador**.</p>
        </div>

        <div class="card">
            <h4>Dividindo a Coluna "Produto"</h4>
            <p>Como produtos como **"TCL 40'' Classe 3 - Series HD LED - Preto"** t√™m m√∫ltiplos tra√ßos, usaremos o delimitador mais √† direita para isolar a cor/caracter√≠stica.</p>
            <ol>
                <li>Selecione a coluna **"Produto"**.</li>
                <li>V√° para a guia **Transformar** e clique em **Dividir Coluna** > **Por Delimitador**.
                    <img src="img/Dividir Coluna por Delimitador.png" alt="Janela de Divis√£o de Coluna por Delimitador no Power Query." class="screenshot">
                </li>
                <li>Na janela "Dividir Coluna por Delimitador":
                    <ul>
                        <li>**Selecionar ou inserir delimitador:** Selecione **Personalizado** e digite **` - `** (espa√ßo, tra√ßo, espa√ßo).</li>
                        <li>**Dividir em:** Selecione **O Delimitador mais √† direita**.</li>
                    </ul>
                </li>
                <li>Clique em **OK**.</li>
                <li>**Renomeie** as novas colunas para **"Nome do Produto"** e **"Detalhe do Produto"**.</li>
            </ol>
        </div>
      </section>
      
      <section class="sub-section">
        <h2>6Ô∏è‚É£ Padroniza√ß√£o de Texto (Strings) <i class="fas fa-text-width"></i></h2>
        <p>Para garantir que nossos relat√≥rios n√£o dupliquem contagens por causa de textos em caixa alta ou baixa (Ex: 'VERMELHO' vs 'vermelho'), precisamos padronizar o formato do texto.</p>

        <div class="card">
            <h4>Limpando Caixas e Espa√ßos</h4>
            <p>Vamos aplicar duas transforma√ß√µes essenciais em todas as colunas de texto que ser√£o usadas em filtros (como **Marca** e **Detalhe do Produto**):</p>
            <ol>
                <li>Selecione as colunas **"Detalhe do Produto"** e **"Marca"** (use a tecla Ctrl para selecionar m√∫ltiplas).</li>
                <li>Na guia **Transformar**, clique em **Formato** e selecione **"Min√∫sculas"** (ou **"Primeira Letra de Cada Palavra em Mai√∫scula"**). Usaremos **Min√∫sculas**.</li>
                <li>Ainda nas colunas selecionadas, clique em **Formato** novamente e selecione **"Aparar"**.</li>
            </ol>
            <blockquote class="note">
                <i class="fas fa-lightbulb"></i> **Por que Aparar?** O comando "Aparar" remove espa√ßos em branco indesejados no in√≠cio e no fim das c√©lulas. Isso evita que textos como " Mouse" (com um espa√ßo extra) sejam tratados como diferentes de "Mouse" (sem o espa√ßo). √â um passo simples, mas vital para a qualidade dos dados.
            </blockquote>
            <p>Com a tabela `dProdutos` completamente tratada, clique em **"Fechar e Aplicar"** para carregar a tabela no modelo do Power BI.</p>
        </div>
      </section>
      
      <section class="sub-section">
        <h2>7Ô∏è‚É£ Modelagem de Dados: Criando o C√©rebro do BI <i class="fas fa-project-diagram"></i></h2>
        <p>Agora que `dClientes` e `dProdutos` est√£o limpas, vamos entender o conceito central da nossa pr√≥xima etapa: conectar os dados.</p>
        <div class="card">
            <h4>Tabelas Fato vs. Tabelas Dimens√£o (O Esquema Estrela)</h4>
            <p>Em um projeto de BI, dividimos nossos dados em dois tipos principais:</p>
            <ul>
                <li><i class="fas fa-table"></i> <strong>Tabelas Dimens√£o (Dim Tables - D):</strong> S√£o tabelas que *descrevem* algo. Elas s√£o a base da sua an√°lise (ex: `dClientes`, `dProdutos`). Elas cont√™m atributos (Nome, G√™nero, Marca).</li>
                <li><i class="fas fa-coins"></i> <strong>Tabelas Fato (Fact Tables - F):</strong> S√£o tabelas que cont√™m as *medi√ß√µes* ou *transa√ß√µes*. Elas cont√™m n√∫meros que voc√™ quer somar ou contar (ex: uma tabela `fVendas` com a Quantidade, Valor e Data).</li>
            </ul>
            <p>O objetivo √© construir o **Esquema Estrela**: conectar todas as Tabelas Dimens√£o (as bordas da estrela) √† Tabela Fato (o centro da estrela).</p>
        </div>
      </section>

      <section class="sub-section">
        <h2>8Ô∏è‚É£ Tratando Erros de Fonte de Dados <i class="fas fa-exclamation-triangle"></i></h2>
        <p>No dia a dia, √© comum que a fonte original dos seus dados seja movida, renomeada ou que o nome de uma aba ou coluna mude. Isso far√° com que o Power BI falhe ao tentar "Atualizar".</p>

        <div class="card">
            <h4>Dica de Ouro: O Bot√£o "Ir para o Erro"</h4>
            <p>Na maioria dos erros de atualiza√ß√£o no Power Query, voc√™ ver√° uma mensagem na coluna de dados com o bot√£o **"Ir para o Erro"**. Ao clicar nele, o Power Query navegar√° automaticamente at√© a etapa exata onde o erro ocorreu.</p>
            <img src="img/Ir para Erro.png" alt="Mensagem de erro em uma coluna no Power Query com o bot√£o 'Ir para o Erro'." class="screenshot">
        </div>

        <div class="card">
            <h4>Causa 1: Nome da Aba Alterado no Excel</h4>
            <p>Simule a altera√ß√£o do nome da aba (`"Plan1"` para `"DadosNovos"`). O erro ocorre porque o c√≥digo M da etapa "Navega√ß√£o" ainda procura pelo nome antigo da aba.</p>
            <p>A corre√ß√£o √© feita na etapa **"Navega√ß√£o"** (clique na engrenagem) ou editando a Linguagem M na **Barra de F√≥rmulas**.</p>
        </div>

        <div class="card">
            <h4>Causa 2: Coluna Exclu√≠da ou Renomeada no Excel</h4>
            <p>Se voc√™ excluir ou renomear uma coluna no Excel (Ex: apagar a coluna "Observa√ß√£o"), o Power Query falhar√° em qualquer etapa que tentava usar essa coluna.</p>
            <ol>
                <li>Use o bot√£o **"Ir para o Erro"** para localizar a etapa (ex: uma etapa de "Tipo Alterado" ou "Colunas Removidas").</li>
                <li>**Corrigindo Coluna Renomeada:** Se a coluna foi apenas renomeada, clique na etapa do erro e edite o nome antigo (Ex: `"Observa√ß√£o"`) para o novo nome na **Barra de F√≥rmulas** (Linguagem M).</li>
                <li>**Corrigindo Coluna Exclu√≠da:** Se a coluna foi exclu√≠da e n√£o √© mais necess√°ria, voc√™ deve **remover a refer√™ncia a ela** na Linguagem M.
                    <ul>
                        <li>Localize o nome da coluna que n√£o existe mais (ex: `"Observa√ß√£o"`) dentro da lista de colunas que est√° causando o erro.</li>
                        <li>**Apague a refer√™ncia √† coluna:** Por exemplo, se a etapa tenta remover uma coluna que n√£o existe mais, voc√™ deve apagar a refer√™ncia a essa coluna na lista da barra de f√≥rmulas, como mostrado na imagem.</li>
                    </ul>
                    <img src="img/coluna n√£o encontrada.png" alt="Barra de f√≥rmulas no Power Query destacando a sintaxe da Linguagem M, mostrando a necessidade de apagar a refer√™ncia a uma coluna n√£o encontrada." class="screenshot">
                </li>
            </ol>
        </div>
      </section>

      <section class="main-section" style="padding-top: 0; margin-top: -20px;">
        <section class="sub-section" style="border-left-color: var(--cor-borda-amarelo-pbi);">
            <h2>üèÜ Pr√≥ximos Passos (O Desafio da Conex√£o)</h2>
            <p>As Tabelas Dimens√£o (`dClientes` e `dProdutos`) est√£o prontas e agora voc√™ sabe como resolver problemas de conex√£o! Mas a pergunta "Quais produtos as clientes do sexo feminino compram?" ainda n√£o pode ser respondida, pois nos falta a tabela de transa√ß√µes.</p>
            <p style="font-weight: bold; font-size: 1.1em;">Na pr√≥xima aula, vamos:</p>
            <ul>
                <li>Importar a Tabela Fato (`fVendas`).</li>
                <li>Aprender a criar Relacionamentos autom√°ticos e manuais na **Guia Modelo**.</li>
                <li>Criar nosso primeiro KPI financeiro com DAX.</li>
            </ul>
        </section>
      </section>

    </section>

  </main>

  <a href="#" id="back-to-top" class="back-to-top" title="Voltar ao topo">
    <i class="fas fa-chevron-up"></i>
  </a>

  <script src="js/quotes.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {

      // --- C√ìDIGO DA CITA√á√ÉO RAND√îMICA ---
      const quoteElement = document.querySelector('.thought-of-the-day p');
      const authorElement = document.querySelector('.thought-of-the-day cite');

      if (quoteElement && authorElement && typeof quotes !== 'undefined' && quotes.length > 0) {
        const randomIndex = Math.floor(Math.random() * quotes.length);
        const randomQuote = quotes[randomIndex];

        quoteElement.textContent = `"${randomQuote.quote}"`;
        authorElement.textContent = `‚Äî ${randomQuote.author}`;
      } else if (quoteElement) {
         quoteElement.textContent = "Bem-vindo √† sua jornada de dados.";
         authorElement.textContent = "";
      }
      
      // --- C√ìDIGO DO MENU HAMB√öRGUER (Mobile) ---
      const sidebar = document.getElementById('sidebar');
      const content = document.getElementById('content');
      const hamburgerMenu = document.getElementById('hamburger-menu');
      const overlay = document.getElementById('overlay');
      const sidebarLinks = sidebar.querySelectorAll('a');

      function toggleSidebarMobile() {
        sidebar.classList.toggle('active');
        content.classList.toggle('sidebar-active');
        overlay.classList.toggle('active');
      }

      hamburgerMenu.addEventListener('click', toggleSidebarMobile);
      overlay.addEventListener('click', toggleSidebarMobile);

      // --- L√ìGICA DE CLIQUE NOS LINKS ---
      sidebarLinks.forEach(link => {
        link.addEventListener('click', function(event) {

          if (link.classList.contains('active')) {
            event.preventDefault();

            if (sidebar.classList.contains('active')) {
              toggleSidebarMobile();
            }
            return;
          }

          if (sidebar.classList.contains('active')) {
            toggleSidebarMobile();
          }
        });
      });

      // --- C√ìDIGO DO TOGGLE DO SIDEBAR (Desktop) ---
      const desktopToggleBtn = document.getElementById('sidebar-toggle-btn');
      if (desktopToggleBtn) {
        desktopToggleBtn.addEventListener('click', () => {
          if (window.innerWidth > 768) {
            sidebar.classList.toggle('sidebar-mini');
            content.classList.toggle('sidebar-mini');
          }
        });
      }

      // --- C√ìDIGO DO BOT√ÉO "VOLTAR AO TOPO" ---
      const backToTopButton = document.getElementById('back-to-top');
      window.addEventListener('scroll', () => {
        if (window.scrollY > 300) {
          backToTopButton.classList.add('show');
        } else {
          backToTopButton.classList.remove('show');
        }
      });

      // --- C√ìDIGO DO BOT√ÉO "MOSTRAR RESPOSTA" ---
      const toggleBtn = document.querySelector('.toggle-answer-btn');
      const answerDiv = document.querySelector('.answer');
      if (toggleBtn && answerDiv) {
        toggleBtn.addEventListener('click', () => {
          const isVisible = answerDiv.style.display === 'block';
          if (isVisible) {
            answerDiv.style.display = 'none';
            toggleBtn.innerHTML = '<i class="fas fa-eye"></i> Mostrar Gabarito';
          } else {
            answerDiv.style.display = 'block';
            toggleBtn.innerHTML = '<i class="fas fa-eye-slash"></i> Esconder Gabarito';
          }
        });
      }

    });
  </script>
</body>

</html>